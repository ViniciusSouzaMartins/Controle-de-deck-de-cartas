#include<stdio.h>
#include<conio.c>
#include<stdlib.h>
#include<string.h>
#include<ctype.h>
#include<windows.h>

#define TF 100

struct TpJogo
{
	int CodJogo;
	char DescJogo[300];
};typedef struct TpJogo Jogos;

struct TpCarta
{
	int CodCarta, CodJogo, CodDeck;
	char DescCarta[300], NomeCarta[100];
	
};typedef struct TpCarta Cartas;

struct TpDeck
{
	int CodDeck, Ano, CodJogo;
	char Titulo[300], Jogador[100], NomeJogo[300];
	
};typedef struct TpDeck Decks;

void ExibirJogos(char Jogo[100])
{
	Jogos ExibeJogos;	
	FILE *PtrExibJogo = fopen(Jogo,"rb");
	fread(&ExibeJogos, sizeof(Jogos), 1, PtrExibJogo);
	while(!feof(PtrExibJogo))
	{
		printf("Codigo do jogo: %d\nNome do jogo: %s\n\n", ExibeJogos.CodJogo, ExibeJogos.DescJogo);
		fread(&ExibeJogos, sizeof(Jogos), 1, PtrExibJogo);
	}
	getch();	
	fclose(PtrExibJogo);	
}

void ExibirCartas(char Carta[100])
{
	Cartas ExibeCartas;	
	FILE *PtrExibCarta = fopen(Carta,"rb");
	fread(&ExibeCartas, sizeof(Cartas), 1, PtrExibCarta);
	while(!feof(PtrExibCarta))
	{
		printf("Codigo da carta: %d\nNome do carta: %s\nDescricao da carta: %s\nCodigo do deck: %d\n\n", ExibeCartas.CodCarta, ExibeCartas.NomeCarta, ExibeCartas.DescCarta, ExibeCartas.CodDeck);
		fread(&ExibeCartas, sizeof(Cartas), 1, PtrExibCarta);
	}
	getch();	
	fclose(PtrExibCarta);	
}

void ExibirDecks(char Deck[100])
{
	Decks ExibeDecks;	
	FILE *PtrExibDeck = fopen(Deck,"rb");
	fread(&ExibeDecks, sizeof(Decks), 1, PtrExibDeck);
	while(!feof(PtrExibDeck))
	{
		printf("Codigo do deck: %d\nNome do deck: %s\nNome do jogo vinculado: %s\nJogador responsavel: %s\nAno de criacao: %d\n\n", ExibeDecks.CodDeck, ExibeDecks.Titulo, ExibeDecks.NomeJogo,ExibeDecks.Jogador,ExibeDecks.Ano);
		fread(&ExibeDecks, sizeof(Decks), 1, PtrExibDeck);
	}
	getch();	
	fclose(PtrExibDeck);	
}

void BuscaDeckEmJogo(FILE *PtrBuscDeck, int Cod, int Vet[TF], int &TL)
{
	int i=0;
	Decks BuscDeck;
	rewind(PtrBuscDeck);
	fread(&BuscDeck, sizeof(Decks), 1, PtrBuscDeck);
	while(!feof(PtrBuscDeck))
	{
		if(BuscDeck.CodJogo == Cod)
		{		
			printf("\nCodigo do deck: %d\nNome do Deck: %s\n", BuscDeck.CodDeck, BuscDeck.Titulo);
			Vet[i] = BuscDeck.CodJogo;
			i++;
			TL++;
		}
		fread(&BuscDeck, sizeof(Decks), 1, PtrBuscDeck);
	}
	
}


int BuscaCartaEmDeck(FILE *PtrCarta, int Codigo)
{
	int i=0;
	Cartas RelCartaB;
	rewind(PtrCarta);
	fread(&RelCartaB, sizeof(Cartas), 1, PtrCarta);
	while(!feof(PtrCarta))
	{
		if(RelCartaB.CodDeck == Codigo)
		{		
			printf("\nCartas vinculadas a esse deck: ");
			printf("- %s\n", RelCartaB.NomeCarta);			
			i++;	
		}
		fread(&RelCartaB, sizeof(Cartas), 1, PtrCarta);
	}
	if(i==0)
		printf("\nEsse deck nao possui cartas vinculadas!\n");
	else
		printf("\nQuantidade de cartas vinculadas a esse deck: %d", i);
}

int BuscaJogo(FILE *PtrBuscaJogo, int Codigo)
{
	Jogos CadJogo;
	rewind(PtrBuscaJogo);
	fread(&CadJogo, sizeof(Jogos), 1, PtrBuscaJogo);
	while(!feof(PtrBuscaJogo) && CadJogo.CodJogo != Codigo)
		fread(&CadJogo, sizeof(Jogos), 1, PtrBuscaJogo);
		
	if(!feof(PtrBuscaJogo))
		return ftell(PtrBuscaJogo) - sizeof(Jogos);
	else 
		return -1;	
}
int BuscaCarta(FILE *PtrBuscaCarta, int Cod)
{
	Cartas CadCarta;
	rewind(PtrBuscaCarta);	
	fread(&CadCarta, sizeof(Cartas), 1, PtrBuscaCarta);
	while(!feof(PtrBuscaCarta) && CadCarta.CodCarta != Cod)
		fread(&CadCarta, sizeof(Cartas), 1, PtrBuscaCarta);	
		
	if(!feof(PtrBuscaCarta))
		return ftell(PtrBuscaCarta) - sizeof(Cartas);
	else 
		return -1;	
}
int BuscaDeck(FILE *PtrBuscaDeck, int Cod)
{
	Decks CadDeck;
	rewind(PtrBuscaDeck);	
	fread(&CadDeck, sizeof(Decks), 1, PtrBuscaDeck);
	while(!feof(PtrBuscaDeck) && CadDeck.CodDeck != Cod)
		fread(&CadDeck, sizeof(Decks), 1, PtrBuscaDeck);	
		
	if(!feof(PtrBuscaDeck))
		return ftell(PtrBuscaDeck) - sizeof(Decks);
	else 
		return -1;	
}

void RelatorioDecks(char Deck[100], char Carta[100])
{
	FILE *PtrRelDeck = fopen(Deck, "rb");	
	FILE *PtrRelCarta = fopen(Carta, "rb");
	int pos;	
	Decks RelDeck;
	Cartas RelCarta;	
	fread(&RelDeck, sizeof(Decks), 1, PtrRelDeck);
	if(!feof(PtrRelDeck))
	{
		clrscr();
		printf("\nDigite o codigo do deck: ");
		scanf("%d", &RelDeck.CodDeck);
		if(BuscaDeck(PtrRelDeck, RelDeck.CodDeck) == -1)
			printf("\nDeck Inexistente!\n");
		else
		{
			clrscr();
			pos = BuscaDeck(PtrRelDeck, RelDeck.CodDeck);
			fseek(PtrRelDeck, pos, 0);
			fread(&RelDeck, sizeof(Decks), 1, PtrRelDeck);
			printf("--> Deck: %s\n\nJogo: %s - (%d)\n\n- Jogador responsavel: %s\n\n", RelDeck.Titulo, RelDeck.NomeJogo, RelDeck.Ano, RelDeck.Jogador);			
			BuscaCartaEmDeck(PtrRelCarta, RelDeck.CodDeck);			
		}		
	}
	getch();
	fclose(PtrRelDeck);
	fclose(PtrRelCarta);
}

int Verif(FILE *PtrBuscaDeck, int CodJogo, int CodDeck, int pos)
{
	Decks CadDeck;
	fseek(PtrBuscaDeck, pos, 0);
	fread(&CadDeck, sizeof(Decks), 1, PtrBuscaDeck);
	if(CadDeck.CodDeck == CodDeck && CadDeck.CodJogo == CodJogo)
		return 1;
	else
		return 0;
}
int VerifC(FILE *PtrBuscaCarta, int pos, int CodJogo, int CodDeck)
{
	Cartas CadCarta;
	fseek(PtrBuscaCarta, pos, 0);
	fread(&CadCarta, sizeof(Cartas), 1, PtrBuscaCarta);
	if(CadCarta.CodDeck == 0 && CadCarta.CodJogo == CodJogo)
		return 0;
	if(CadCarta.CodJogo != CodJogo && pos != -1)
		return 1;
	if(CadCarta.CodDeck > 0 && CadCarta.CodDeck != CodDeck)
		return 2;
	if(CadCarta.CodDeck == CodDeck)
		return 3;
}


void CadastroJogos(char Jogo[100])
{
	int Codigo;
	system("cls");
	FILE *PtrCadJogo = fopen(Jogo, "ab+");
	Jogos CadJogo;
	printf("\t####CADASTRO DE JOGOS####");
	printf("\nDigite o Codigo do Jogo(-1 - SAIR): ");
	scanf("%d", &CadJogo.CodJogo);
	while(CadJogo.CodJogo != -1)
	{
		if(BuscaJogo(PtrCadJogo, CadJogo.CodJogo) == -1 && CadJogo.CodJogo > 0)
		{
			printf("\nDigite o nome do Jogo: ");
			fflush(stdin);
			gets(CadJogo.DescJogo);
			
			fwrite(&CadJogo, sizeof(Jogos), 1, PtrCadJogo);	
			printf("\nJOGO CADASTRADO!\n");		
		}
		else
		{		
			system("cls");			
			if(CadJogo.CodJogo == 0)
			{				
				printf("\nO Codigo do jogo deve ser maior que zero!");						
			}
			else
			{				
				printf("\nO jogo com codigo %d ja existe!", CadJogo.CodJogo);					
			}
		}
		getch();
		system("cls");
		printf("\t####CADASTRO DE JOGOS####");
		printf("\nDigite o Codigo do Jogo(-1 - SAIR): ");
		scanf("%d", &CadJogo.CodJogo);		
	}
	fclose(PtrCadJogo);
}
void CadastroCartas(char Carta[100], char Jogo[100])
{
	FILE *PtrCadCarta = fopen(Carta, "ab+");
	FILE *PtrCadJogo = fopen(Jogo, "rb");
	Cartas CadCarta;
	Jogos CadJogo;
	system("cls");
	printf("\t####CADASTRO DE CARTAS####");
	printf("\nDigite o codigo de um jogo existente(-1 - SAIR): ");
	scanf("%d", &CadJogo.CodJogo);
	while(CadJogo.CodJogo != -1)
	{
		if(CadJogo.CodJogo == 0 && CadJogo.CodJogo < -1)
		{
			printf("\nO codigo do jogo deve ser maior que zero!");
		}
		else
		{
			if(BuscaJogo(PtrCadJogo, CadJogo.CodJogo) == -1 && CadJogo.CodJogo > 0)
			{
				printf("\n O jogo com codigo %d nao existe!", CadJogo.CodJogo);
			}
			else
			{
				printf("\nDigite o codigo da carta(-1 - SAIR): ");				
				scanf("%d", &CadCarta.CodCarta);
				
				while(CadCarta.CodCarta != -1)
				{					
					if(BuscaCarta(PtrCadCarta, CadCarta.CodCarta) == -1 && CadCarta.CodCarta > 0)
					{
						CadCarta.CodJogo = CadJogo.CodJogo;
						CadCarta.CodDeck = 0;
						printf("\nDigite o nome da carta: ");
						fflush(stdin);
						gets(CadCarta.NomeCarta);
						fflush(stdin);
						printf("\nDescricao: ");
						gets(CadCarta.DescCarta);
						
						fwrite(&CadCarta, sizeof(Cartas),1,PtrCadCarta);
						printf("\nCarta cadastrada!\n");
					}
					else
						if(CadCarta.CodCarta == 0)
						{
							printf("\nO codigo da carta deve ser maior que zero!\n");
						}
						else
							if(BuscaCarta(PtrCadCarta, CadCarta.CodCarta) != -1)
							{							
								printf("\nA carta com codigo %d ja existe!\n", CadCarta.CodCarta);							
							}										
				
					printf("Digite o codigo da carta(-1 - SAIR): ");					
					scanf("%d", &CadCarta.CodCarta);					
				}
			}
		}
		printf("\nDigite o codigo do jogo(-1 - SAIR): ");
		scanf("%d", &CadJogo.CodJogo);		
	}
	fclose(PtrCadJogo);
	fclose(PtrCadCarta);	
}
void CadastroDecks(char Deck[100], char Jogo[100])
{
	int pos;
	FILE *PtrCadDeck = fopen(Deck, "ab+");
	FILE *PtrCadJogo = fopen(Jogo, "rb");
	Decks CadDeck;
	Jogos CadJogo;
	printf("\t####CADASTRO DE DECKS####");
	printf("\n\nDigite o codigo do jogo(-1 - SAIR): ");
	scanf("%d", &CadJogo.CodJogo);
	while(CadJogo.CodJogo !=-1)
	{
		if(CadJogo.CodJogo == 0)
			printf("\nO codigo do jogo deve ser maior que zero!\n");
		else
		{
			if(BuscaJogo(PtrCadJogo, CadJogo.CodJogo) == -1)
				printf("\nO jogo com codigo %d nao existe!\n", CadJogo.CodJogo);
			else
			{
				system("cls");
				printf("Digite o codigo do deck(-1 - SAIR): ");
				scanf("%d", &CadDeck.CodDeck);
				while(CadDeck.CodDeck != -1)
				{
					if(CadDeck.CodDeck == 0)
						printf("O codigo do deck deve ser maior que zero!\n");
					else
						if(BuscaDeck(PtrCadDeck, CadDeck.CodDeck) == -1)
						{
							pos = BuscaJogo(PtrCadJogo, CadJogo.CodJogo);							
							CadDeck.CodJogo = CadJogo.CodJogo;
							fseek(PtrCadJogo, pos, 0);
							fread(&CadJogo, sizeof(Jogos),1,PtrCadJogo);
							strcpy(CadDeck.NomeJogo, CadJogo.DescJogo);
							printf("\nDigite o nome do deck: ");
							fflush(stdin);
							gets(CadDeck.Titulo);
							printf("\nJogador Responsavel: ");
							fflush(stdin);
							gets(CadDeck.Jogador);
							printf("\nAno de criacao: ");
							fflush(stdin);
							scanf("%d", &CadDeck.Ano);							
							fwrite(&CadDeck, sizeof(Decks), 1, PtrCadDeck);
							printf("\n\n DECK CADASTRADO!\n\n");
						}
						else
							if(BuscaDeck(PtrCadDeck, CadDeck.CodDeck) != -1)
								printf("\nO deck com codigo %d ja existe!", CadDeck.CodDeck);
					printf("\nDigite o codigo do deck(-1 - SAIR): ");
					scanf("%d", &CadDeck.CodDeck);				
				}
				
			}
		}
		printf("\t\n####CADASTRO DE DECKS####\n");
		printf("\nDigite o codigo do jogo(-1 - SAIR): ");
		scanf("%d", &CadJogo.CodJogo);
	}
	
	fclose(PtrCadDeck);
	fclose(PtrCadJogo);
}
void CadastroCartaInDeck(char Jogo[100], char Deck[100], char Carta[100])
{
	FILE *PtrCadJogo = fopen(Jogo, "rb");
	FILE *PtrCadDeck = fopen(Deck, "rb+");
	FILE *PtrCadCarta = fopen(Carta, "rb+");
	Jogos CadJogo;
	Decks CadDeck;
	Cartas CadCarta;
	int pos;
	printf("\t####CADASTRO DE CARTAS EM DECKS####");
	printf("\nDigite o codigo do jogo(-1 - SAIR): ");
	scanf("%d", &CadJogo.CodJogo);
	while(CadJogo.CodJogo != -1)
	{
		if(CadJogo.CodJogo == 0)
			printf("\nO codigo do jogo deve ser maior que zero!\n");
		else
		{
			if(BuscaJogo(PtrCadJogo, CadJogo.CodJogo) == -1)
				printf("\nO jogo com %d nao existe!\n", CadJogo.CodJogo);
			else
			{
				printf("\nDigite o codigo do deck(-1 - SAIR): ");
				scanf("%d", &CadDeck.CodDeck);
				while(CadDeck.CodDeck != -1)
				{
					if(CadDeck.CodDeck == 0)
						printf("\nO codigo do deck deve ser maior que zero!\n");
					else
						pos = BuscaDeck(PtrCadDeck, CadDeck.CodDeck);
						if(Verif(PtrCadDeck, CadJogo.CodJogo, CadDeck.CodDeck, pos) == 1)
						{
							printf("\nDigite o codigo da carta(-1 - SAIR): ");
							scanf("%d", &CadCarta.CodCarta);
							while(CadCarta.CodCarta != -1)
							{
								if(CadCarta.CodCarta == 0)
									printf("\nO codigo da carta deve ser maior que zero!\n");
								else
								{
									pos = BuscaCarta(PtrCadCarta, CadCarta.CodCarta);
									if(VerifC(PtrCadCarta, pos, CadJogo.CodJogo, CadDeck.CodDeck) == 0 && pos != -1)
									{											
										fseek(PtrCadCarta, pos, 0);
										fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
										CadCarta.CodDeck = CadDeck.CodDeck;									
										printf("\nNome da carta: %s\nCod deck: %d\n", CadCarta.NomeCarta, CadCarta.CodDeck);
										printf("\nDeseja cadastrar a carta? (S-N): ");
										if(toupper(getch()) == 'S')
										{
											fseek(PtrCadCarta, pos, 0);										
											fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
											printf("\n\nCARTA CADASTRADA!\n\n");																														
										}
									}
									else
									{									
										if(VerifC(PtrCadCarta, pos, CadJogo.CodJogo, CadDeck.CodDeck) == 1)
											printf("\nA carta com codigo %d nao pertence a esse jogo!\n", CadCarta.CodCarta);
										if(VerifC(PtrCadCarta, pos, CadJogo.CodJogo, CadDeck.CodDeck) == 2)
											printf("\nA carta com codigo %d pertence a outro deck!\n", CadCarta.CodCarta);
										if(VerifC(PtrCadCarta, pos, CadJogo.CodJogo, CadDeck.CodDeck) == 3)
											printf("\nA carta com codigo %d ja pertence a esse deck!\n", CadCarta.CodCarta);
									}
										
									if(BuscaCarta(PtrCadCarta, CadCarta.CodCarta) == -1)
									{
										fseek(PtrCadCarta, 0, 2);
										fread(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
										CadCarta.CodJogo = CadJogo.CodJogo;
										CadCarta.CodDeck = CadDeck.CodDeck;
										printf("\nDigite o nome da carta: ");
										fflush(stdin);
										gets(CadCarta.NomeCarta);
										printf("\nDigite a descricao da carta: ");
										fflush(stdin);
										gets(CadCarta.DescCarta);
										fwrite(&CadCarta, sizeof(Cartas), 1, PtrCadCarta);
										printf("\nCARTA CADASTRADA!\n");										
									}
									
								}								
								printf("\nDigite o codigo da carta: ");
								scanf("%d", &CadCarta.CodCarta);
							}							
						}
						else
							if(Verif(PtrCadDeck, CadJogo.CodJogo, CadDeck.CodDeck, pos) == 0 && BuscaDeck (PtrCadDeck, CadDeck.CodDeck) != -1)
								printf("\nO deck com codigo %d esta vinculado a outro jogo!\n");
							else
								printf("\nO Deck com codigo %d nao existe!", CadDeck.CodDeck);
								
					printf("\nDigite o codigo do deck(-1 - SAIR): ");
					scanf("%d", &CadDeck.CodDeck);
				}					
			}
		}
		printf("\t\n####CADASTRO DE CARTA(S) EM DECK(S)####");
		printf("\nDigite o codigo do jogo(-1 - SAIR): ");
		scanf("%d", &CadJogo.CodJogo);	
	}	
	fclose(PtrCadCarta);
	fclose(PtrCadJogo);
	fclose(PtrCadDeck);	
}

/*
void ExclusaoLogicaJogo(char Jogo[100], char Carta[100], char Deck[100])
{
	clrscr();
	FILE *PtrExJogo = fopen(Jogo, "rb");
	FILE *PtrExCarta = fopen(Carta, "rb");
	FILE *PtrExDeck = fopen(Deck, "rb");
	FILE *PtrExTempJogo, *PtrExTempDeck;
	Jogos ExJogo;
	Decks ExDeck;
	int cod, PosJogo, PosCarta, PosDeck, Vet[TF], i=0, TL;
	
	printf("\t\n###EXCLUSAO DE JOGO###\n");
	printf("\nDigite o codigo do jogo(-1 - SAIR): ");
	scanf("%d", &ExJogo.CodJogo);
	if(BuscaJogo(PtrExJogo, ExJogo.CodJogo) != -1)
	{
		PosJogo=BuscaJogo(PtrExJogo,ExJogo.CodJogo);
		fseek(PtrExJogo, PosJogo, 0);
		fread(&ExJogo, sizeof(Jogos), 1, PtrExJogo);		
		printf("\nCodigo do jogo: %d\nNome do Jogo: %s", ExJogo.CodJogo, ExJogo.DescJogo);
	//	PosCarta = BuscaCartaEmJogo(PtrExCarta, ExJogo.CodJogo);
		BuscaDeckEmJogo(PtrExDeck, ExJogo.CodJogo, Vet, TL);
		printf("\nDeseja excluir esse jogo? - (S/N): ");
		if(toupper(getch()) == 'S')
		{
			PtrExTempJogo = fopen("TempJogo.dat", "wb");
			PtrExTempDeck = fopen("TempDeck.dat", "wb");
			cod = ExJogo.CodJogo;			
			rewind(PtrExJogo);
			fread(&ExJogo, sizeof(Jogos), 1, PtrExJogo);
			while(!feof(PtrExJogo))
			{
				if(ExJogo.CodJogo != cod)				
					fwrite(&ExJogo, sizeof(Jogos), 1,PtrExTempJogo);
				
				fread(&ExJogo, sizeof(Jogos), 1,PtrExJogo);				
			}
			fseek(PtrExDeck, Vet[i], 0);
			fread(&ExDeck, sizeof(Decks), 1, PtrExDeck);
			while(i<TL)
			{							
				fwrite(&ExJogo, sizeof(Jogos), 1, PtrExTempDeck);
				i++;
				fseek(PtrExDeck, Vet[i], 0);
				fread(&ExDeck, sizeof(Decks), 1, PtrExDeck);
			}
				
			fclose(PtrExJogo);
			fclose(PtrExDeck);
			fclose(PtrExTempJogo);
			fclose(PtrExTempDeck);
			remove(Jogo);
			remove(Deck);
			rename("TempJogo.dat", Jogo);
			rename("TempDeck.dat", Deck);
			printf("\nJogo excluido!\n");
			printf("\nDeck(s) Excluido(s)\n");
		}
			
	}	
	else
		printf("\nO Jogo com codigo %d nao existe!\n", ExJogo.CodJogo);
	getch();
	fclose(PtrExJogo);
	fclose(PtrExDeck);
	fclose(PtrExCarta);			
}
*/


char Menu()
{
	system("cls");
	printf("####Menu####");
	printf("\n\n[A] - Cadastro de Jogos\n");
	printf("\n[B] - Cadastro de Cartas\n");
	printf("\n[C] - Cadastro de Decks\n");
	printf("\n[D] - Cadastro de Carta(s) no Deck(s)\n");
	printf("\n[E] - Exibir Jogos\n");
	printf("\n[F] - Exibir Cartas\n");
	printf("\n[G] - Exibir Decks\n");
	printf("\n[H] - Relatorio de Decks\n");
	printf("\n[I] - Excluir Jogo\n");
	return getch();
}

void Executar(void)
{
	char op;	
	do
	{
		op = toupper(Menu());
		
		switch(op)
		{
			case 'A': CadastroJogos("Jogos.dat");
					  break;
			case 'B': CadastroCartas("Cartas.dat","Jogos.dat");
					  break;
			case 'C': CadastroDecks("Decks.dat", "Jogos.dat");
					  break;
			case 'D': CadastroCartaInDeck("Jogos.dat", "Decks.dat", "Cartas.dat");
					  break;
			case 'E': ExibirJogos("Jogos.dat");
					  break;
			case 'F': ExibirCartas("Cartas.dat");
					  break;
			case 'G': ExibirDecks("Decks.dat");	
					  break;
			case 'H': RelatorioDecks("Decks.dat", "Cartas.dat");
					  break;
			//case 'I': ExclusaoLogicaJogo("Jogos.dat", "Cartas.Deck", "Decks.dat");
			//		  break;	
		}
	}while(op!=27);
}


int main()
{	
	FILE *PtrJogo = fopen("Jogos.dat","rb");
	FILE *PtrCarta = fopen("Cartas.dat","rb");
	FILE *PtrDeck = fopen("Decks.dat","rb");
	if(PtrJogo ==  NULL)
	{
		printf("\nArquivo nao existe!\n");
		printf("\nDeseja cria-lo?(S/N)\n");
		if(toupper(getch()) == 'S')
		{
			printf("\nCriando Arquivo...\n");
			Sleep(1000);
			PtrJogo = fopen("Jogos.dat","wb");
			printf("\nArquivo Criado!\n");
		}		
	}	
	if(PtrCarta ==  NULL)
	{
		printf("\nArquivo nao existe!\n");
		printf("\nDeseja cria-lo?(S/N)\n");
		if(toupper(getch()) == 'S')
		{
			printf("\nCriando Arquivo...\n");
			Sleep(1000);
			PtrJogo = fopen("Cartas.dat","wb");
			printf("\nArquivo Criado!\n");
		}		
	}	
	if(PtrDeck ==  NULL)
	{
		printf("\nArquivo nao existe!\n");
		printf("\nDeseja cria-lo?(S/N)\n");
		if(toupper(getch()) == 'S')
		{
			printf("\nCriando Arquivo...\n");
			Sleep(1000);
			PtrJogo = fopen("Decks.dat","wb");
			printf("\nArquivo Criado!\n");
		}		
	}
	fclose(PtrDeck);
	fclose(PtrCarta);
	fclose(PtrJogo);	
	Executar();
}


//EXCLUSÃO LÓGICA DO JOGO

void ExclusaoLogicaCartas (char Nome[100], int cod)
{
	TpCarta Cartas;
	FILE *PtrArq= fopen (Nome, "rb+");
	fread(&Cartas,sizeof(TpCartas),1,PtrArq);
	while(!feof(PtrArq))
	{
		if(Cartas.CodJogo == cod)
		{
			Cartas.Status='I';
			fseek(PtrArq,ftell(PtrArq)-sizeof(TpCarta),0);
			fwrite(Cartas,sizeof(TpCartas),1,PtrArq);
		}
		fread(&Cartas,sizeof(TpCartas),1,PtrArq);
	}
	fclose(PtrArq);
}

void ExclusaoLogicaDecks (char Nome[100], int cod)
{
	TpDeck Decks;
	FILE *PtrArq = fopen (Nome, "rb+");
	fread(&Decks,sizeof(TpDeck),1,PtrArq);
	while(!feof(PtrArq))
	{
		if(Decks.CodJogo == cod)
		{
			Decks.Status='I';
			fseek(PtrArq,ftell(PtrArq)-sizeof(TpDeck),0);
			fwrite(Decks,sizeof(TpDeck),1,PtrArq);
		}
		fread(&Decks,sizeof(TpDecks),1,PtrArq);
	}
	fclose(PtrArq);
}

void ExibirJogos(char Jogo[100]) //fiz so p ver se tava dando certo
{
	Jogos ExibeJogos;	
	FILE *PtrExibJogo = fopen(Jogo,"rb");
	fread(&ExibeJogos, sizeof(Jogos), 1, PtrExibJogo);
	while(!feof(PtrExibJogo) && ExibeJogos.Status=='A')
	{
		printf("Codigo do jogo: %d\nNome do jogo: %s\n\n", ExibeJogos.CodJogo, ExibeJogos.DescJogo);
		fread(&ExibeJogos, sizeof(Jogos), 1, PtrExibJogo);
	}
	getch();	
	fclose(PtrExibJogo);	
}

void ExclusaoLogicaJogo(char Jogo[100]) 
{
	FILE *PtrExJogo = fopen(Jogo, "rb+");
	Jogos ExJogo;
	
	printf("\t\n###EXCLUSAO DE JOGO###\n");
	printf("\nDigite o codigo do jogo(-1 - SAIR): ");
	scanf("%d", &ExJogo.CodJogo);
	posJogo = BuscaJogo(PtrExJogo, ExJogo.CodJogo);
	if(posJogo>=0)
	{
		fseek(PtrExJogo, PosJogo, 0);
		fread(&ExJogo, sizeof(Jogos), 1, PtrExJogo);		
		printf("\nCodigo do jogo: %d\nNome do Jogo: %s", ExJogo.CodJogo, ExJogo.DescJogo);
		printf("\nDeseja excluir logicamente este jogo? - (S/N): ");
		if(toupper(getch()) == 'S')
		{
			ExJogo.Status = 'I'			
			fseek(PtrExJogo, PosJogo, 0);
			fwrite(ExJogo, sizeof(Jogos), 1, PtrExJogo);
			ExcluiLogicaCartas(NomeDoArquivo,ExJogo.CodJogo);//tem q arrumar esses parametros rs
	  		ExcluiLogicaDecks(NomeDoArquivo,ExJogo.CodJogo);
	  		printf("Jogo Excluido Logicamente!\n");
	    }
	}	
	else
		printf("\nO Jogo com codigo %d nao existe!\n", ExJogo.CodJogo);
	getch();
	fclose(PtrExJogo);
}


//EXCLUSÃO LÓGICA DAS CARTAS
void ExcluiCartasLogic (char Nome[100]) 
{
	int cod, pos, car;
	FILE *PtrArq = fopen(Nome,"rb+");
	TpCarta Cartas;
	printf("###EXCLUSAO DE CARTAS###\n");
	printf("Digite o codigo do jogo:\n");
	scanf("%d",&cod);
	while(cod>0)
	{
		pos = BuscaJogo(PtrArq,cod);
		if(pos>0)
		{
			printf("Digite o codigo da carta:\n");
			scanf("%d",&car);
			pos = BuscaCarta(PtrArq,car);
			if(pos>0)
			{
				fseek(PtrArq,pos,0);
				fread(&Cartas,sizeof(TpCarta),1,PtrArq);
				printf("Codigo da carta:%d\nNome da Carta:%s\nDescricao:%s\n",Cartas.CodCarta,Cartas.NomeCarta,Cartas.DescCarta);
				printf("\nDeseja excluir logicamente esta carta? - (S/N): ");
				if(toupper(getch()) == 'S')
				{
					Cartas.Status='I';
					fseek(PtrArq, pos, 0);
					fwrite(Cartas, sizeof(TpCarta), 1, PtrArq);
					printf("Carta Excluida!\n";)
				}
			}
			else 
				printf("Carta nao existente!\n");
		}
		else 
			printf("Jogo nao existente!\n");
		printf("Digite o codigo do jogo:\n");
		scanf("%d",&cod);
	}	
	fclose(PtrArq);
}


//EXCLUSÃO LÓGICA DOS DECKS 
void ExcluiCartasDoDeck(char Nome[100], int deck)
{
	FILE *PtrArq = fopen(Nome,'rb+');
	TpCarta Cartas;
	fread(&Cartas,sizeof(TpCarta),1,PtrArq);
	while(!feof(PtrArq))
	{
		if(Cartas.CodDeck==deck)
		{
			Cartas.Status='I';
			fseek(PtrArq,ftell(PtrArq)-sizeof(TpCarta),0);
			fwrite(Cartas,sizeof(TpCartas),1,PtrArq);
		}
		fread(&Cartas,sizeof(TpCarta),1,PtrArq);
	}
	fclose(PtrArq);
}

void ExclusaoDeckLogic (char Nome[100])
{
	int cod, pos, deck;
	FILE *PtrArq = fopen (Nome,"rb+");
	TpDeck Decks;
	printf("###EXCLUSAO DE DECKS###\n");
	printf("Digite o codigo do jogo:\n");
	scanf("%d",&cod);
	while(cod>0)
	{
		pos = BuscaJogo(PtrArq,cod);
		if(cod>0)
		{
			printf("Digite o codigo do Deck:\n");
			scanf("%d",&deck);
			pos = BuscaDeck(PtrArq,deck);
			if(pos>0)
			{
				fseek(PtrArq,pos,0);
				fread(&Decks,sizeof(TpDeck),1,PtrArq);
				printf("Nome do Jogo:%s\nJogador Responsavel:%s\n",Decks.NomeJogo,Decks.Jogador);
				printf("\nDeseja excluir logicamente esta carta? - (S/N): ");
				if(toupper(getch()) == 'S')
				{
					Decks.Status='I';
					fseek(PtrArq,pos,0);
					fwrite(Decks,sizeof(TpDeck),1,PtrArq);	
					ExcluiCartasDoDeck(NomeArquivo,deck);
					printf("Deck excluido!\n";)
				}
			}
			else 
				printf("Deck Inexistente!\n");
		}
		else
			printf("Jogo Inexistente!\n");
		printf("Digite o codigo do jogo:\n");
		scanf("%d",&cod);	
	}
	fclose(PtrArq);
}
